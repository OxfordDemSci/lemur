# docker compose containers for nginx reverse proxy, shinyproxy, shiny app, flask api, and postgresql database.
version: '3.9'

services:
  
  # nginx:
  #   image: nginx:latest
  #   container_name: nginx
  #   volumes:
  #     - ./:/var/www
  #     - ./deploy/nginx.conf:/etc/nginx/conf.d/default.conf
  #   ports:
  #     - 80:80
  #   networks:
  #     - lemur-network
  #   depends_on:
  #     - api
  #     - lemur
  #   restart: unless-stopped
  # 
  # lemur:
  #   
  # 
  # api:
  #   build:
  #     context: ./
  #     dockerfile: api.Dockerfile
  #   container_name: api
  #   command: gunicorn --config gunicorn_config.py wsgi:app
  #   volumes:
  #     - ./:/var/www
  #     - data:/app/app/data:ro
  #   networks:
  #     lemur-network:
  #       aliases:
  #         - api
  #   restart: unless-stopped

  postgres:
    image: postgres:latest
    ports: 5432:5432
    env_file: .env
    volumes:
      - /srv/lemur/data/:/var/lib/postgresql/data/
    restart: unless-stopped

  
networks:
  lemur-network:

